---
title: "Sugest√µes de melhorias e coment√°rios"
subtitle: "MEDIDAS DE DIAGN√ìSTICO EM MODELOS DE REGRESS√ÉO BETA PRIME"
date: "23/08/2023 as 14h00"
lang: pt
author: "Prof. Dr. Pedro Rafael D. Marinho"
format: html
code-tools: true
code-copy: true
number-sections: true
page-layout: full
editor: source
---

# Objetivos principais e observa√ß√µes:

Os objetivos principais do trabalho s√£o:

1. Estudo dos res√≠duos do modelo de regress√£o beta prime, para al√©m do que Bourguignon et al. (2021) considerou.

2. Bourguignon et al. (2021) considerou os res√≠duo quant√≠lico e do de Pearson;

3. Aqui foram considerados os res√≠duo:
  + res√≠duos ponderado;
  + **ponderado padronizado**. Esse foi o res√≠duo proposto;
  + Pearson padronizado.

4. Avalia-se a distribui√ß√£o emp√≠rica dos
res√≠duos em diferentes cen√°rios do modelo de regress√£o BP e comparamos seus desempenhos
para detectar especifica√ß√£o incorreta.

5. A distribui√ß√£o beta prime pode ser escrita na fam√≠lia exponencial de distribui√ß√µes. Portanto, "compete" com os modelos lineares generalizados.

7. Densidade da Beta Prime


$$f(y;\alpha, \beta) = \frac{y^{\alpha - 1}(1 + y)^{-(\alpha + \beta)}}{B(\alpha, \beta)}, y \geq 0,$$
com $\alpha > 0$ e  $\beta > 0$.

# Seguest√µes e coment√°rios

## Suporte da distribui√ß√£o BP

O suporte da distribui√ß√£o da beta prime n√£o inclue o zero ($y \geq 0$)? Sei que Bourguignon et al. (2021) definiu como $y > 0$, mas n√£o seria $y \geq 0$? Note que na p√°gina 34 do paper (p√°gina 2 do PDF), √∫ltimo par√°grafo, ele diz:

> Pode-se provar que a fun√ß√£o densidade BP est√° diminuindo com $f(y|\alpha,\beta)$, se $0 < \alpha < 1$ e f $f(y|\alpha, \beta)$ √© decrescente com moda em $y = 0$. - Bourguignon et al. (2021)

Al√©m disso, nas refer√™ncias da distribui√ß√£o $y\geq 0$.

**Uma observa√ß√£o**: Ela tamb√©m √© conhecida como distribui√ß√£o de Pearson tipo VI. üéÅ

## Utilizar a teoria da informa√ß√£o

A ideia do estudo √© a avalia√ß√£o dos res√≠duos para a an√°lise da especifica√ß√£o do modelo de regress√£o beta prime. Portanto, queremos estimar $r({\bf x}) = \mathbb{E}(Y|X)$, ou seja, desejamos uma fun√ß√£o de regress√£o com boa capacidade preditiva. Uma das suposi√µes √© que $Y\sim BP$. 

Pergunta: em cen√°rios em que $Y$ segue a distribui√ß√£o aproximadamente BP, utilizar estat√≠sticas de adequa√ß√£o de ajuste para comparar a regress√£o BP com outros modelos de regress√£o, a exemplo, dos MGL's, como, por exemplo, com o modelo MLG com $Y \sim Gama$, a an√°lise de res√≠duos proposta n√£o levam as mesmas conclus√µes de que chegar√≠amos em uma an√°lise de res√≠duo? Por exemplo, utilizar estat√≠sticas como a estat√≠stica de Cram√©r-von Mises e Anderson-Darling para modelos n√£o encaixados n√£o poderia ser √∫til para comparar a distribui√ß√£o de $Y$ e decidir qual modelo melhor se ajusta aos dados? Realizar uma valida√ß√£o cruzada para perceber qual modelo performa melhor √© uma alternativa. Existem situa√ß√µes em que uma valida√ß√£o cruzada me apontaria para uma decis√£o equivocada ou diferente que a an√°lise de res√≠duo? E o contr√°rio?


## Especifica√ß√£o correta garante boa capacidade preditiva?

A especifica√ß√£o adequada do modelo garante boa capacidade preditiva? Segundo a l√≥gica de aprendizagem de m√°quina n√£o! Ver o paper do Leio Breiman:

> [Breiman, L. (2001a). Statistical modeling: The two cultures. Statistical Science, 16(3), 199‚Äì231](https://projecteuclid.org/journalArticle/Download?urlId=10.1214%2Fss%2F1009213726)

Nesse artigo ele estabelece duas culturas na modelagem estat√≠stica:

1. **Data modeling culture**: nela, em geral, se assume que o modelo de regress√£o utilizado $r({\bf x}) = \mathbb{E}(Y|{\bf X})$ √© correto. O principal objetivo dessa abordagem √© a interpreta√ß√£o dos par√¢metros que indexam o modelo $r({\bf x})$.

2. **Algorithmic modeling culture**: essa √© a cultura que domina a comunidade de aprendizagem de m√°quina. Nessa abordagem, o principal objetivo s√£o as predi√ß√µes por meio de novas observa√ß√µes. N√£o se assume que o modelo utilizado √© o modelo correto. Nesse tipo de modelagem, muitas vezes os algoritmos n√£o envolve nenhuma estrutura probabil√≠stica. Muitas vezes, modelos n√£o bem especificado conduzem a boas predi√ß√µes.

Existe uma sequ√™ncia de respostas √† esse paper, por exemplo, estat√≠sticos renomados como o David Cox e o Bradley Efron respondem positivamente √† esse paper.


Podemos ter modelos que n√£o est√£o bem especificados, mas possuem boa performance preditiva. Por exemplo, tente ajustar um [random forest](https://hastie.su.domains/ISLR2/ISLRv2_corrected_June_2023.pdf) em um problema, mesmo $Y \in B(\alpha,\beta)$, em um grande conjunto de dados, e usando um conjunto de teste, calcule o erro quadr√°tico m√©dio observado na amostra independente. Muito provavelmente o *random forest* ter√° uma capacidade preditiva igual ou superior ao modelo de regress√£o BP.

Dessa forma, sugiro voc√™ comentar um pouco mais qual a grande import√¢ncia da boa especifica√ß√£o do modelo. Essa boa especifica√ß√£o n√£o est√° √∫nica e exclusivamente na capacidade preditiva do modelo, pois muitas vezes poderemos nos surpreender com modelos n√£o muito bem especificado e que performa muito melhor. A grande contribui√ß√£o de termos um modelo que esteja bem especificado √© permitir que an√°lises interpretativas possam ser realizadas. √â preciso destacar isso, uma vez que muitas pessoas que est√£o lendo materiais da estat√≠stica s√£o pessoas da ci√™ncia de dados/computa√ß√£o, em que muitas dalas "pregam" que o interesse est√° na previs√£o e ofuscam a import√¢ncia de ter modelos bem especificados quando desejamos perceber a rela√ß√£o entre as vari√°veis, construir intervalos para os par√¢metros e testar hip√≥teses.

No material fica um pouco nebuloso de qual a grande ideia de se fazer uma an√°lise de res√≠duos.


## Pensam em adicionar penaliza√ß√£o?

Sei que voc√™s focaram em desenvolver infer√™ncia para auxiliar a an√°lise de especifica√ß√£o do modelo de regress√£o BP. Por√©m, voc√™s pensaram dar passos para avan√ßar o modelo de regress√£o BP, por exemplo, pensam em adicionar algum tipo de penaliza√ß√£o no modelo de regress√£o beta prime? Existe um *trade off* entre vi√©s e vari√¢ncia, em que uma penaliza√ß√£o poderia fazer com que o modelo viesse performar melhor. Um estudo avaliando a peformance do modelo com e sem penaliza√ß√£o, em diversos cen√°rios poderia ser interessante.


## A vari√¢ncia do modelo de regress√£o BP √© maior? Como assim?

Voc√™ diz:

> "Uma das vantagens refere-se √† modelagem de dados mais dispersos, uma vez que a vari√¢ncia do
modelo de regress√£o BP √© maior que a vari√¢ncia do modelo gama." - Maria Eduarda, p√°gina 12

Voc√™ refere-se √† vari√¢ncia do modelo ou a capacidade do modelo em modelar $Y$ com maior vari√¢ncia? O risco preditivo do modelo n√£o sofre com modelos com maior vari√¢ncia? Veja que o risco preditivo $R(\widehat{g})$, usando a norma $L_2$ no risco preditivo de um modelo de regress√£o, temos que o risco poder√° ser decomposto como:

$$R(\widehat{g}) = \mathbb{E}\left[(Y - \widehat{g}({\bf X}))^2| {\bf X} = {\bf x}\right] = \underbrace{\mathbb{V}[Y | {\bf X = x}]}_{\mathrm{i - Vari√¢ncia\,\, intr√≠nseca}} + \overbrace{(r({\bf x}) - \mathbb{E}[\widehat{g}({\bf x})])^2}^{\mathrm{ii - Vi√©s\, ao\, quadrado\, do\, modelo}} + \underbrace{\mathbb{V}[\widehat{g}({\bf x})]}_{\mathrm{iii - Vari√¢ncia\, do\, modelo}},$$ 

em que $\widehat{g}(\cdot)$ √© sua fun√ß√£o de regress√£o estimada. Quando voc√™ diz que a vari√¢ncia do modelo de regress√£o BP √© maior, voc√™ n√£o est√° dizendo que iii √© maior? Isso n√£o me daria um maior risco preditivo? Escreva melhor o que voc√™ est√° querendo dizer com vari√¢ncia maior!

Muito provavelmente existem diversas sequ√™ncias de observa√ß√µes de $Y$ em que poderiam ser bem modeladas pela distribui√ß√£o Gama e tamb√©m pela distribui√ß√£o BP. Se o modelo de regress√£o BP tem vari√¢ncia maior, poderia entender que modelar por um MLG eu teria um modelo que performa melhor? Como foi verificado que a vari√¢ncia do modelo √© maior! Isso √© realmente algo bom?

Voc√™ n√£o estaria querendo dizer que o modelo de regress√£o BP modela dados mais dispersos? Isso pode ser diferente de um modelo com vari√¢ncia maior.


## O que √© precis√£o dos dados?

> Por outro lado, o res√≠duo ponderado padronizado aqui proposto dever√° ser
utilizado com cautela, dado que os experimentos de Monte Carlo revelaram que a proximidade
da sua distribui√ß√£o emp√≠rica pela distribui√ß√£o normal padr√£o depende da precis√£o dos dados
ajustados pelo modelo de regress√£o BP. - Maria Eduarda, p√°gina 41, primeira linha.

**Precis√£o dos dados? Essa express√£o √© estranha!**

O que tem que ser preciso s√£o os modelos. Acho que voc√™ se refere √† converg√™ncia assint√≥tica das estimativas dos erros, nesse caso, do estimador do res√≠duo ponderado padronizado, denotado no trabalho por $r_i^{\beta^*}$ para a distribui√ß√£o normal. Da√≠, quando $n \rightarrow +\infty$ temos que pela Teorema Central do Limite, $r_i^{\beta^*}$ deve convergir em distribui√ß√£o para a distribui√ß√£o normal. **Precis√£o de dados** tem outra conota√ß√£o!


## Cad√™ os demais c√≥digos?

No c√≥digo das simula√ß√µes h√° diversas inter√ß√µes de c√≥digos R com o a fun√ß√£o `source()`. Onde est√£o esses arquivos. Sugiro criar uma conta no [GitHub](https://github.com/) e criar um reposit√≥rio com o script R e um pequeno coment√°rio do que cada c√≥digo faz.

  + Onde est√° `gamlss_BP.R`?
  + Onde est√° `glmBP.R`?
  + Onde est√° `Estimation.R`?
  + Onde est√° `Residual_H_Log_Like_BP.R`?
  
√â preciso que seu experimento seja totalmente repoduz√≠vel. Quem ler quer chegar aos mesmos resultados!